{
    "name": "NASA Astronomy Picture of the Day (MMS)",
    "nodes": [
      {
        "parameters": {
          "rule": {
            "interval": [
              {
                "field": "hours",
                "hoursInterval": 24
              }
            ]
          }
        },
        "name": "Schedule Trigger",
        "type": "n8n-nodes-base.scheduleTrigger",
        "typeVersion": 1.2,
        "position": [
          -820,
          40
        ]
      },
      {
        "parameters": {
          "resource": "apod",
          "operation": "get"
        },
        "name": "NASA",
        "type": "n8n-nodes-base.nasa",
        "typeVersion": 1,
        "position": [
          -600,
          40
        ],
        "credentials": {
          "nasaApi": "nasa-api-credentials"
        }
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "leftValue": "={{ $json.media_type }}",
                "rightValue": "image",
                "operator": {
                  "type": "string",
                  "operation": "equals"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "name": "Check Media Type",
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          -380,
          40
        ]
      },
      {
        "parameters": {
          "functionCode": "// For image media type\nconst item = JSON.parse(JSON.stringify(items[0].json));\n\nreturn [{\n  json: {\n    title: item.title,\n    explanation: item.explanation,\n    date: item.date,\n    imageUrl: item.url,\n    copyright: item.copyright || 'NASA',\n    hdUrl: item.hdurl || item.url,\n    message: `ðŸš€ NASA Astronomy Picture of the Day: ${item.title}\\n\nDate: ${item.date}\\n\n${item.explanation.substring(0, 140)}...\
\nCopyright: ${item.copyright || 'NASA'}`\n  }\n}];"
        },
        "name": "Format Image Data",
        "type": "n8n-nodes-base.function",
        "typeVersion": 1,
        "position": [
          -160,
          20
        ]
      },
      {
        "parameters": {
          "functionCode": "// For video media type\nconst item = JSON.parse(JSON.stringify(items[0].json));\n\nreturn [{\n  json: {\n    title: item.title,\n    explanation: item.explanation,\n    date: item.date,\n    videoUrl: item.url,\n    copyright: item.copyright || 'NASA',\n    message: `ðŸŽ¥ NASA Astronomy Picture of the Day: ${item.title}\\n\nDate: ${item.date}\\n\n${item.explanation.substring(0, 140)}...\
\nVideo: ${item.url}\
\nCopyright: ${item.copyright || 'NASA'}`\n  }\n}];"
        },
        "name": "Format Video Data",
        "type": "n8n-nodes-base.function",
        "typeVersion": 1,
        "position": [
          -160,
          200
        ]
      },
      {
        "parameters": {
          "method": "POST",
          "url": "=https://api.twilio.com/2010-04-01/Accounts/{{$env.TWILIO_ACCOUNT_SID}}/Messages.json",
          "authentication": "predefinedCredentialType",
          "nodeCredentialType": "twilioApi",
          "sendBody": true,
          "contentType": "form-urlencoded",
          "bodyParameters": {
            "parameters": [
              {
                "name": "From",
                "value": "={{$env.TWILIO_PHONE_NUMBER}}"
              },
              {
                "name": "To",
                "value": "={{$env.RECIPIENT_PHONE_NUMBER}}"
              },
              {
                "name": "Body",
                "value": "={{ $json.title }}\\n\n{{ $json.explanation }}"
              },
              {
                "name": "MediaUrl",
                "value": "={{ $json.imageUrl }}"
              }
            ]
          },
          "options": {}
        },
        "name": "Send MMS",
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.1,
        "position": [
          120,
          80
        ],
        "credentials": {
          "twilioApi": "twilio-api-credentials"
        }
      },
      {
        "parameters": {
          "method": "POST",
          "url": "=https://api.twilio.com/2010-04-01/Accounts/{{$env.TWILIO_ACCOUNT_SID}}/Messages.json",
          "authentication": "predefinedCredentialType",
          "nodeCredentialType": "twilioApi",
          "sendBody": true,
          "contentType": "form-urlencoded",
          "bodyParameters": {
            "parameters": [
              {
                "name": "From",
                "value": "={{$env.TWILIO_PHONE_NUMBER}}"
              },
              {
                "name": "To",
                "value": "={{$env.RECIPIENT_PHONE_NUMBER}}"
              },
              {
                "name": "Body",
                "value": "={{ $json.message }}"
              },
              {
                "name": "MediaUrl",
                "value": "={{ $json.videoUrl }}"
              }
            ]
          },
          "options": {}
        },
        "name": "Send Video MMS",
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.1,
        "position": [
          100,
          240
        ],
        "credentials": {
          "twilioApi": "twilio-api-credentials"
        }
      },
      {
        "parameters": {
          "content": "## Twilio configuration needed\n1. Set up Twilio credentials in n8n\n2. Add environment variables:\n   - `TWILIO_ACCOUNT_SID`\n   - `TWILIO_AUTH_TOKEN`\n   - `TWILIO_PHONE_NUMBER`\n   - `RECIPIENT_PHONE_NUMBER`\n3. Update the workflow with your Twilio Account SID in the HTTP request URLs"
        },
        "name": "Configuration Note",
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          -800,
          200
        ]
      }
    ],
    "pinData": {},
    "connections": {
      "Schedule Trigger": {
        "main": [
          [
            {
              "node": "NASA",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "NASA": {
        "main": [
          [
            {
              "node": "Check Media Type",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Check Media Type": {
        "main": [
          [
            {
              "node": "Format Image Data",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Format Video Data",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Format Image Data": {
        "main": [
          [
            {
              "node": "Send MMS",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Format Video Data": {
        "main": [
          [
            {
              "node": "Send Video MMS",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    },
    "active": false,
    "settings": {},
    "id": "nasa-apod-mms-workflow",
    "meta": {
      "instanceId": "c1a2b3c4-d5e6-f7g8-h9i0-j1k2l3m4n5o6p"
    },
    "tags": ["nasa", "apod", "mms", "twilio"]
  }
